---
title: "p8105_hw2_yl5505"
author: "Yan Li"
date: "2024-10-01"
output: github_document
---

# Problem 0
```{r}
library(tidyverse)
library(readxl)
library(dplyr)
```

# Problem 1
```{r}
nyc_sub = 
  read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") |>
  janitor::clean_names() |>
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, exit_only, vending, entrance_type, 
    ada) |> 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))

nyc_sub
```
-- the dataset has information of Division, Line, Station Name, Station Latitude, and Station Longitude. 
-- the dataset is not tidy,becasue each variable should have its own column. I standardized the column names to a consistent format,selected only relevant columns, and I converted entry variable from character to a logical variable.
-- 1868 rows and 20 columns


## How many distinct stations are there?
```{r}
nyc_sub |> 
  select(station_name, line) |> 
  distinct()
```
-- 465 distinct stations

## How many stations are ADA compliant?
```{r}
nyc_sub |> 
  filter(ada == TRUE) |> 
  select(station_name, line) |> 
  distinct()
```
-- 84 are ADA compliant

## What proportion of station entrances / exits without vending allow entrance?

```{r}
no_vending = filter(nyc_sub, vending == "NO")
total_no_vending = nrow(no_vending)
allow_entrance = sum(pull(no_vending, entry))
proportion_no_entry = allow_entrance / total_no_vending

proportion_no_entry
```
-- the proportion is 37.7%. 


## How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?
```{r}
nyc_sub |> 
  mutate(across(starts_with("route"), as.character)) |> 
  pivot_longer(
    cols = starts_with("route"), 
    names_to = "route_num", 
    values_to = "route") |> 
  filter(route == "A") |> 
  select(station_name, line) |> 
  distinct() |> 
  count()

```
-- 60 distinct stations serve the A train.

```{r}
nyc_sub |> 
  mutate(across(starts_with("route"), as.character)) |> 
  pivot_longer(
    cols = starts_with("route"), 
    names_to = "route_num", 
    values_to = "route") |> 
  filter(route == "A", ada == TRUE) |> 
  select(station_name, line) |> 
  distinct() |> 
  count() 

```
-- 17 of the stations are ADA compliant. 


# Problem 2
-- import and clean datasets
```{r}
mr_wheel = read_excel("data/202409 Trash Wheel Collection Data.xlsx", 
                       sheet = "Mr. Trash Wheel", 
                       skip = 1, 
                       na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  select(dumpster:homes_powered)|>
  filter(!is.na(dumpster)) |> 
  mutate(sports_balls = as.integer(round(sports_balls)),
         wheel_type = "Mr. Trash Wheel", year = as.character(year))


mr_wheel
```

```{r}
prof_wheel = read_excel("data/202409 Trash Wheel Collection Data.xlsx", 
                       sheet = "Professor Trash Wheel", 
                       skip = 1, 
                       na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  select(dumpster:homes_powered)|>
  filter(!is.na(dumpster)) |>
  mutate(wheel_type = "Professor Trash Wheel", year = as.character(year))

prof_wheel
```

```{r}
gwynnda_wheel = read_excel("data/202409 Trash Wheel Collection Data.xlsx", 
                       sheet = "Gwynnda Trash Wheel", 
                       skip = 1, 
                       na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  select(dumpster:homes_powered)|>
  filter(!is.na(dumpster)) |>
  mutate(wheel_type = "Gwynnda Trash Wheel", year = as.character(year))

gwynnda_wheel
```

-- Combine three datasets
```{r}
combined_wheels = bind_rows(mr_wheel, prof_wheel,gwynnda_wheel)

combined_wheels
```



